version: "3"

networks:
  traefik-public:
    external: true

volumes:
  ineo-sync-data:
    driver: local

services:
  ineo-run:
    image: registry.diginfra.net/tsd/ineo-sync:0.3
    container_name: ineo-sync
    volumes:
      - ineo-sync-data:/src/data
    restart: unless-stopped
    networks:
      - traefik-public

  rumbledb:
    image: rumbledb/rumble:latest
    container_name: rumbledb
    volumes:
      - ineo-sync-data:/data
    restart: unless-stopped
    command: ["serve", "-p", "8001", "-h", "0.0.0.0", "--driver-memory", "2G", "--executor-memory", "2G"]
    environment:
      - JAVA_OPTS=-Xmx6g -Xms6g
    networks:
      - traefik-public
    depends_on:
      - python-run
  